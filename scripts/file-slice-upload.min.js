!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.fileSliceUpload=e():t.fileSliceUpload=e()}(self,(function(){return(()=>{"use strict";var t={130:(t,e,n)=>{n.r(e),n.d(e,{create:()=>b,default:()=>m});var r={};function i(t,e){return Object.is(t,e)}function o(t,e){return(null==t?void 0:t.constructor)===e}function u(t){return!!Number.isInteger(t)}function c(t,e){if(!o(e,Array))return!1;if(!u(t))return!1;var n=e[0],r=e[1];return n<=t&&r>=t}function s(t){return!!t}function a(t,e){if(Object.is(t,e))return!0;if("object"!=typeof t||"object"!=typeof e)return!1;if((null==t?void 0:t.constructor)!==(null==e?void 0:e.constructor))return!1;if([t,e].includes(null))return!1;var n=Object.keys(t),r=Object.keys(e);return n.length===r.length&&n.every((function(n){return a(t[n],e[n])}))}function l(t,e){return!!e.includes(t)||e.findIndex((function(e){return a(e,t)}))>-1}function f(t){return!!u(t)&&t>0}n.r(r),n.d(r,{equal:()=>i,inRange:()=>c,int:()=>u,ok:()=>s,oneOf:()=>l,positiveInt:()=>f,shallowEq:()=>a,truth:()=>d,typeOf:()=>o});var p=[null,void 0,!1,NaN];function d(t){return!p.includes(t)}var h,v=(h=function(t,e){return h=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},h(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}h(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),y=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.name="AssertTiny",e}return v(e,t),e}(Error),b=function(t){var e=function(){function t(){var t=this;this.SLIENT=!1,this.NOT=!1,this.value=function(e){return t.VALUE=e,t}}return t.prototype.result=function(t,e,n){if((!t||this.NOT)&&(t||!this.NOT)){var r=e?"".concat(e):"".concat(n," assert error");if(this.SLIENT&&console.warn(new y(r)),!this.SLIENT)throw new y(r)}},Object.defineProperty(t.prototype,"not",{get:function(){return this.NOT=!0,this},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"slient",{get:function(){return this.SLIENT=!0,this},enumerable:!1,configurable:!0}),t}(),n=Object.getPrototypeOf(new e),i=Object.assign(t||{},r),o=Object.keys(i).reduce((function(e,n){var r,i,o,u="is".concat((void 0===i&&(i=0),void 0===o&&(o=1),"".concat((r=n).slice(i,o).toUpperCase()).concat(r.slice(o))));return e[u]=function(e,r){var i=this;t[n](i.VALUE,e)?i.result(!0,r,u):i.result(!1,r,u)},e}),{});return Object.assign(n,o),function(t){return(new e).value(t)}};const m=b({})},205:(t,e,n)=>{n.r(e),n.d(e,{Emitter:()=>i,default:()=>o});var r=n(130),i=function(){var t=this;this.eventBus={},this.on=function(e,n){(0,r.default)(e).isTypeOf(String,"eventName must be a string"),(0,r.default)(n).isTypeOf(Function,"callback must be a funtion");var i=t.eventBus;return Array.isArray(i[e])?i[e].push(n):i[e]=[n],t},this.emit=function(e,n){(0,r.default)(e).isTypeOf(String,"eventName must be a string");var i=t.eventBus;Array.isArray(i[e])&&i[e].forEach((function(t){return t(n)}))},this.off=function(e,n){(0,r.default)(e).isTypeOf(String,"eventName must be a string"),(0,r.default)(n).isTypeOf(Function,"callback must be a funtion");var i=t.eventBus;Array.isArray(i[e])&&(i[e]=i[e].filter((function(t){return n!==t})))},this.once=function(e,n){(0,r.default)(e).isTypeOf(String,"eventName must be a string"),(0,r.default)(n).isTypeOf(Function,"callback must be a funtion");var i=function(){for(var r=[],o=0;o<arguments.length;o++)r[o]=arguments[o];n.apply(void 0,r),t.off(e,i)};t.on(e,i)}};const o=i},202:function(t,e,n){var r=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};e.__esModule=!0;var i=r(n(64)),o=r(n(128)),u=r(n(30)),c=r(n(130)),s=r(n(205)),a=function(){function t(t){void 0===t&&(t=1),this.parallel=t,this.chunkArr=[],this.event=new s.default}return t.prototype.on=function(t,e){return(0,c.default)(e).isTypeOf(Function,"handler expecte function type"),this.event.on(t,e),this},t.prototype.off=function(t,e){return(0,c.default)(e).isTypeOf(Function,"handler expecte function type"),this.event.off(t,e),this},t.prototype.file=function(t,e){(0,c.default)(t).isTypeOf(File,"file expecte File type"),(0,c.default)(e).isTypeOf(String,'chunkSizeStr expecte String type likes `"2MB"`'),this.file_=t;var n=(0,o.default)(e),r=(0,i.default)(t,n);if([0,1,void 0].includes(this.parallel))return this.chunkArr=r,this;for(var u=0,s=[];r.slice(u*n,u*n+n);)s.push(r.slice(u*n,u*n+n)),u++;return this.chunkArr=s,this},t.prototype.uploadFunc=function(t){return(0,c.default)(t).isTypeOf(Function,"expecte Function"),this.uploadFunc_=t,this},t.prototype.start=function(){var t,e;return(0,c.default)(this.uploadFunc_).isTypeOf(Function,"please set upload function use .uploadFunc()"),(0,c.default)(this.file_).isTypeOf(File,"please set upload file use .file(file)"),null===(e=null===(t=this.flow)||void 0===t?void 0:t.stop)||void 0===e||e.call(t),this.event.emit("start","start"),this.flow=(0,u.default)(this.uploadFunc_,this.chunkArr,this.event,0),this},t.prototype.stop=function(){var t,e;return this.event.emit("stop","stop"),null===(e=null===(t=this.flow)||void 0===t?void 0:t.stop)||void 0===e||e.call(t),this},t.prototype.continue=function(){var t;return(null===(t=this.flow)||void 0===t?void 0:t.continue)&&(this.flow=this.flow.continue()),this.event.emit("continue","continue"),this},t}();e.default=a},607:function(t,e,n){var r=this&&this.__createBinding||(Object.create?function(t,e,n,r){void 0===r&&(r=n),Object.defineProperty(t,r,{enumerable:!0,get:function(){return e[n]}})}:function(t,e,n,r){void 0===r&&(r=n),t[r]=e[n]}),i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};e.__esModule=!0,e.fileUpload=void 0;var o=i(n(202));r(e,n(202),"default","fileUpload"),e.default=function(t){return void 0===t&&(t=1),new o.default(t)}},30:function(t,e,n){var r=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function u(t){try{s(r.next(t))}catch(t){o(t)}}function c(t){try{s(r.throw(t))}catch(t){o(t)}}function s(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(u,c)}s((r=r.apply(t,e||[])).next())}))},i=this&&this.__generator||function(t,e){var n,r,i,o,u={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function c(o){return function(c){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;u;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return u.label++,{value:o[1],done:!1};case 5:u.label++,r=o[1],o=[0];continue;case 7:o=u.ops.pop(),u.trys.pop();continue;default:if(!((i=(i=u.trys).length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){u=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){u.label=o[1];break}if(6===o[0]&&u.label<i[1]){u.label=i[1],i=o;break}if(i&&u.label<i[2]){u.label=i[2],u.ops.push(o);break}i[2]&&u.ops.pop(),u.trys.pop();continue}o=e.call(t,u)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,c])}}},o=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};e.__esModule=!0;var u=o(n(205));e.default=function t(e,n,o,c){void 0===n&&(n=[]),void 0===o&&(o=new u.default),void 0===c&&(c=0);var s={val:!1},a=n.slice(c),l=c;return a.length?(function(){r(this,void 0,void 0,(function(){var t,r;return i(this,(function(i){switch(i.label){case 0:return a.length?(t=a.shift(),[4,e(t,l,n)]):[3,2];case 1:return!0!==(r=i.sent())?(o.emit("error","error"),console.error("error"),[3,2]):!0===r&&!1===s.val?(o.emit("progress",{done:l+1,all:n.length}),o.emit("chunk-uploaded",{chunk:t,index:l,chunks:n}),l++,[3,0]):!0===s.val?(console.warn("stop"),o.emit("stop","stop"),[3,2]):[3,0];case 2:return a.length||(console.warn("finish"),o.emit("finish","finish")),[2]}}))}))}(),{stop:function(){s.val=!0},continue:function(){return s.val=!0,t(e,n,o,l)}}):{}}},64:(t,e)=>{e.__esModule=!0;var n=function(t,e){return"".concat(t.name,"-").concat(e)};e.default=function(t,e,r){void 0===e&&(e=0);for(var i=Math.ceil(t.size/e),o=[],u=0;u<i;){var c=t.slice(u*e,u*e+e),s=r?r(t,u):n(t,u);o.push(new File([c],s,{type:t.type})),u++}return o}},128:(t,e)=>{e.__esModule=!0;var n={BYTE:1,K:1024,KB:1024,M:1048576,MB:1048576};e.default=function(t){var e=Object.keys(n).find((function(e){return new RegExp("".concat(e.toUpperCase(),"$")).test(t.toUpperCase())}));if(!e)return 0;var r=n[e],i=t.split(e)[0];if(isNaN(Number(i)))throw new Error("must be number string");return Number(i)*r}}},e={};function n(r){var i=e[r];if(void 0!==i)return i.exports;var o=e[r]={exports:{}};return t[r].call(o.exports,o,o.exports,n),o.exports}n.d=(t,e)=>{for(var r in e)n.o(e,r)&&!n.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:e[r]})},n.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),n.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})};var r=n(607);return r.default})()}));