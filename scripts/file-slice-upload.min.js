!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.fileSliceUpload=e():t.fileSliceUpload=e()}(self,(function(){return(()=>{"use strict";var t={202:function(t,e,n){var r=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};e.__esModule=!0;var o=r(n(275)),i=r(n(64)),u=r(n(128)),l=r(n(30)),s=n(316),a=function(){function t(t){void 0===t&&(t=1),this.parallel=t,this.chunkArr=[],this.event=new o.default}return t.prototype.on=function(t,e){return(0,s.mAssertType)(e,Function,"handler expecte function type"),this.event.on(t,e),this},t.prototype.file=function(t,e){(0,s.mAssertType)(t,File,"file expecte File type"),(0,s.mAssertType)(e,String,'chunkSizeStr expecte String type likes `"2MB"`'),this.file_=t;var n=(0,u.default)(e),r=(0,i.default)(t,n);if([0,1,void 0].includes(this.parallel))return this.chunkArr=r,this;for(var o=0,l=[];r.slice(o*n,o*n+n);)l.push(r.slice(o*n,o*n+n)),o++;return this.chunkArr=l,this},t.prototype.uploadFunc=function(t){return(0,s.mAssertType)(t,Function,"expecte Function"),this.uploadFunc_=t,this},t.prototype.start=function(){var t,e;return(0,s.mAssertType)(this.uploadFunc_,Function,"please set upload function use .uploadFunc()"),(0,s.mAssertType)(this.file_,File,"please set upload file use .file(file)"),null===(e=null===(t=this.flow)||void 0===t?void 0:t.stop)||void 0===e||e.call(t),this.event.emit("start","start"),this.flow=(0,l.default)(this.uploadFunc_,this.chunkArr,this.event,0),this},t.prototype.stop=function(){var t,e;return this.event.emit("stop","stop"),null===(e=null===(t=this.flow)||void 0===t?void 0:t.stop)||void 0===e||e.call(t),this},t.prototype.continue=function(){var t,e,n;return this.event.emit("continue","continue"),(null===(t=this.flow)||void 0===t?void 0:t.continue)&&(this.flow=null===(n=null===(e=this.flow)||void 0===e?void 0:e.continue)||void 0===n?void 0:n.call(e)),this},t}();e.default=a},607:function(t,e,n){var r=this&&this.__createBinding||(Object.create?function(t,e,n,r){void 0===r&&(r=n),Object.defineProperty(t,r,{enumerable:!0,get:function(){return e[n]}})}:function(t,e,n,r){void 0===r&&(r=n),t[r]=e[n]}),o=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};e.__esModule=!0,e.fileUpload=void 0;var i=o(n(202));r(e,n(202),"default","fileUpload"),e.default=function(t){return void 0===t&&(t=1),new i.default(t)}},30:function(t,e,n){var r=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))((function(o,i){function u(t){try{s(r.next(t))}catch(t){i(t)}}function l(t){try{s(r.throw(t))}catch(t){i(t)}}function s(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(u,l)}s((r=r.apply(t,e||[])).next())}))},o=this&&this.__generator||function(t,e){var n,r,o,i,u={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function l(i){return function(l){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;u;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return u.label++,{value:i[1],done:!1};case 5:u.label++,r=i[1],i=[0];continue;case 7:i=u.ops.pop(),u.trys.pop();continue;default:if(!((o=(o=u.trys).length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){u=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){u.label=i[1];break}if(6===i[0]&&u.label<o[1]){u.label=o[1],o=i;break}if(o&&u.label<o[2]){u.label=o[2],u.ops.push(i);break}o[2]&&u.ops.pop(),u.trys.pop();continue}i=e.call(t,u)}catch(t){i=[6,t],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,l])}}},i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};e.__esModule=!0;var u=i(n(275));e.default=function t(e,n,i,l){void 0===n&&(n=[]),void 0===i&&(i=new u.default),void 0===l&&(l=0);var s={val:!1},a=n.slice(l),c=0;return a.length?(function(){r(this,void 0,void 0,(function(){var t,r;return o(this,(function(o){switch(o.label){case 0:return a.length?(t=a.shift(),[4,e(t,c,n)]):[3,2];case 1:return!0!==(r=o.sent())?(i.emit("error","error"),console.error("error"),[3,2]):!0===r&&!1===s.val?(i.emit("progress",{done:c+1,all:n.length}),i.emit("uploaded",{chunk:t,index:c,chunks:n}),c++,[3,0]):!0===s.val?(console.warn("stop"),i.emit("stop","stop"),[3,2]):[3,0];case 2:return a.length||console.warn("finish"),[2]}}))}))}(),{stop:function(){return s.val=!0},continue:function(){return s.val=!0,t(e,n,i,c)}}):{}}},316:(t,e)=>{e.__esModule=!0,e.mAssertType=e.mAssert=void 0,e.mAssert=function(t,e,n){if(t!==e)throw new Error(n)},e.mAssertType=function(t,e,n){if((null==t?void 0:t.constructor)!==e)throw new Error(n)}},275:(t,e)=>{e.__esModule=!0;var n=function(){function t(){this.container={}}return t.prototype.on=function(t,e){var n=this.container;Array.isArray(n[t])?n[t].push(e):n[t]=[e]},t.prototype.emit=function(t,e){var n=this.container;Array.isArray(n[t])&&n[t].forEach((function(t){return t(e)}))},t.prototype.off=function(t,e){var n=this.container;Array.isArray(n[t])&&(n[t]=n[t].filter((function(t){return t!==e})))},t.prototype.once=function(t,e){var n=this,r=function(){for(var o=[],i=0;i<arguments.length;i++)o[i]=arguments[i];e.apply(void 0,o),n.off(t,r)};this.on(t,r)},t}();e.default=n},64:(t,e)=>{e.__esModule=!0;var n=function(t,e){return"".concat(t.name,"-").concat(e)};e.default=function(t,e,r){void 0===e&&(e=0);for(var o=Math.ceil(t.size/e),i=new Array(o),u=0;u<o;){var l=t.slice(u*e,u*e+e),s=r?r(t,u):n(t,u);i.push(new File([l],s,{type:t.type})),u++}return i}},128:(t,e)=>{e.__esModule=!0;var n={BYTE:1,K:1024,KB:1024,M:1048576,MB:1048576};e.default=function(t){var e=Object.keys(n).find((function(e){return new RegExp("".concat(e.toUpperCase(),"$"),t.toUpperCase())}));if(!e){var r=n[e],o=t.split(e)[0];if(isNaN(Number(o)))throw new Error("must be number string");return Number(o)*r}}}},e={};return function n(r){var o=e[r];if(void 0!==o)return o.exports;var i=e[r]={exports:{}};return t[r].call(i.exports,i,i.exports,n),i.exports}(607)})()}));